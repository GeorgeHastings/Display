"use strict";var Events=[],OutOfOffice=[],OutOfOfficeImages=[],Calendars={internal:"ideo.com_p0gg0riugm6d554et1jic6okrg@group.calendar.google.com",external:"ideo.com_20hjl85r7mi3e2vtfncskfiabs@group.calendar.google.com",projects:"ideo.com_v4vpo5b47up8803v4omofvet4c@group.calendar.google.com",ooo:"ideo.com_bdpb36toirhifucfijthud9dng@group.calendar.google.com",visitors:"ideo.com_34qgi5b59dtf8ljfls0ojtj804@group.calendar.google.com"},UI={tmpl:document.getElementById("event-template"),eventContainer:document.getElementById("event-container")},Event=function(e,t,n,r,o,a,i,m,s){this.summary=e,this.day=t,this.date=n,this.time=r,this.creator=a,this.where=o,this.calendar=i,this.sortIndex=m,this.dateMonthDay=s},getProfile=function(){var e=gapi.client.directory.users.photos.get({userKey:"dwandrey@ideo.com"});e.execute(function(e){console.log(e)})},sortEventsByTime=function(){Events.sort(function(e,t){return e.sortIndex-t.sortIndex})},renderOutOfOffice=function(e){for(var t="",n=0;n<OutOfOffice.length;n++)getSortIndex(OutOfOffice[n])<e.sortIndex&&getDisplayTime(OutOfOffice[n])[3]>e.dateMonthDay&&OutOfOffice[n].attendees&&(t+='<img data-person="'+OutOfOffice[n].attendees[0].email+'">',OutOfOfficeImages.push(OutOfOffice[n].attendees[0].email));return t},newDay=function(e,t){return 0===e||e>0&&Events[e-1].day!==t.day?!0:void 0},renderEvents=function(){for(var e=0;e<Events.length;e++){var t=Events[e],n=UI.tmpl.content.cloneNode(!0);newDay(e,t)&&(n.querySelector(".date-container").style.display="block",n.querySelector(".event-date").innerHTML=t.day+" "+t.date,n.querySelector(".ooo-container").innerHTML=renderOutOfOffice(t)),n.querySelector(".event").id=t.id,n.querySelector(".event-title").innerHTML=t.summary,n.querySelector(".event-location").innerHTML=t.where,n.querySelector(".event-time").innerHTML=t.time,"All day"===t.time&&(n.querySelector(".event").className+=" all-day"),UI.eventContainer.appendChild(n)}},getDisplayTime=function(e){var t,n,r,o;if(e.start.dateTime){var a=moment(e.start.dateTime);return r=moment(e.start.dateTime).format("dddd"),n=moment(e.start.dateTime).format("M/D"),t=moment(e.end.dateTime),o=moment(e.start.dateTime).format("MDD"),[r,n,""+a.format("h:mm")+" - "+t.format("h:mm a"),o]}var i=e.start.date;return t=moment(e.end.date).format("MDD"),r=moment(i).format("dddd"),n=moment(i).format("M/D"),o=moment(e.start.date).format("MDD"),[r,n,"All day",t]},getCreator=function(e){var t;return t=e.creator.email?e.creator.email:e.organizer.email},getLocation=function(e){var t;return t=e.location?e.location:"New York"},getSortIndex=function(e){var t;t=e.start.dateTime?moment(e.start.dateTime):moment(e.start.date);var n=t.format("MM")+t.format("DD")+t.format("HH mm");return parseInt(n)},buildEvents=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=n.summary,o=getDisplayTime(n)[0],a=getDisplayTime(n)[1],i=getDisplayTime(n)[2],m=getDisplayTime(n)[3],s=getLocation(n),d=getCreator(n),c=n.organizer.displayName,f=getSortIndex(n);Events.push(new Event(r,o,a,i,s,d,c,f,m))}},buildOutOfOffice=function(e){for(var t=0;t<e.length;t++){var n=e[t];OutOfOffice.push(n)}},getRequest=function(e){var t=gapi.client.calendar.events.list({calendarId:e,timeMin:(new Date).toISOString(),showDeleted:!1,singleEvents:!0,maxResults:10,orderBy:"startTime"});return t},listUpComingEvents=function(e){getRequest(Calendars[e]).execute(function(e){"NY - OOO"===e.summary?buildOutOfOffice(e.items):buildEvents(e.items)})},listAllEvents=function(){for(var e in Calendars)listUpComingEvents(e);setTimeout(function(){sortEventsByTime(),renderEvents()},2e3)};