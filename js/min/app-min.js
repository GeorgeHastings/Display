"use strict";var CurrentWeek=0,Events=[],Calendars={internal:"ideo.com_p0gg0riugm6d554et1jic6okrg@group.calendar.google.com",external:"ideo.com_20hjl85r7mi3e2vtfncskfiabs@group.calendar.google.com",projects:"ideo.com_v4vpo5b47up8803v4omofvet4c@group.calendar.google.com"},UI={tmpl:document.getElementById("event-template"),eventContainer:document.getElementById("event-container")},Event=function(e,t,n,r,a,i,o){this.summary=e,this.day=t,this.date=n,this.time=r,this.creator=a,this.calendar=i,this.sortIndex=o};Event.prototype.getColor=function(){return"NY - Creative Connections"===this.calendar?"#DE6B48":"NY - Internal"===this.calendar||"NY - Internal Events"===this.calendar?"#25CED1":"NY - OOO"===this.calendar||"NY - Staff Vacations"===this.calendar?"#379392":"NY - External Events"===this.calendar?"#3F5478":"NY - Client Events"===this.calendar?"#E6AF2E":"rgb(0,155,255)"};var Renderers={renderDateTitles:function(e){for(var t=document.querySelectorAll(".week-container li"),n=["Monday","Tuesday","Wednesday","Thursday","Friday"],r=0;r<t.length;r++)t[r].innerHTML+='<div class="date">'+moment().add(e,"week").day(n[r]).format("dddd M/D")+"</div>"},renderEvents:function(){for(var e=0;e<Events.length;e++){var t=Events[e],n=UI.tmpl.content.cloneNode(!0),r=document.getElementById(t.day);if("All day"===t.time&&(n.querySelector(".event-time").style.display="none"),n.querySelector(".event").id=t.id,n.querySelector(".event-title").innerHTML=t.summary,n.querySelector(".event-time").innerHTML=t.time,n.querySelector(".event-info").style.background=t.getColor(),!r)return;r.appendChild(n)}}},Helpers={getSortIndex:function(e){var t;t=e.start.dateTime?moment(e.start.dateTime):moment(e.start.date);var n=t.format("MM")+t.format("DD")+t.format("HH mm");return parseInt(n)},sortEventsByTime:function(){Events.sort(function(e,t){return e.sortIndex-t.sortIndex})},getDisplayTime:function(e){var t,n;if(e.start.dateTime){var r=moment(e.start.dateTime),a=moment(e.end.dateTime);return t=moment(e.start.dateTime).format("ddd"),n=moment(e.start.dateTime).format("D"),[t,n,""+r.format("h:mm")+" - "+a.format("h:mm a")]}var i=e.start.date;return t=moment(i).format("ddd"),n=moment(i).format("D"),[t,n,"All day"]},getCreator:function(e){var t;return t=e.creator.email?e.creator.email:e.organizer.email},clearCalendar:function(){Events=[];for(var e=document.querySelectorAll(".week-container li"),t=0;t<e.length;t++)e[t].innerHTML=""}},getRequest=function(e,t){var n=gapi.client.calendar.events.list({calendarId:e,timeMin:moment().add(t,"week").isoWeekday(1).format(),timeMax:moment().add(t,"week").isoWeekday(5).format(),showDeleted:!1,singleEvents:!0,maxResults:50,orderBy:"startTime"});return n},buildEvents=function(e){if(e)for(var t=0;t<e.length;t++){var n=e[t],r=n.summary,a=Helpers.getDisplayTime(n)[0],i=Helpers.getDisplayTime(n)[1],o=Helpers.getDisplayTime(n)[2],d=Helpers.getCreator(n),s=n.organizer.displayName,l=Helpers.getSortIndex(n);Events.push(new Event(r,a,i,o,d,s,l))}},createEventObjects=function(e,t){getRequest(Calendars[e],t).execute(function(e){buildEvents(e.items)})},listAllEvents=function(e){for(var t in Calendars)createEventObjects(t,e);setTimeout(function(){Helpers.sortEventsByTime(),Renderers.renderEvents()},2e3)},switchWeek=function(e){"left"===e?CurrentWeek--:CurrentWeek++,Helpers.clearCalendar(),listAllEvents(CurrentWeek),Renderers.renderDateTitles(CurrentWeek)},bindEvents=function(){document.getElementById("pageCalRight").addEventListener("click",function(){switchWeek("right")}),document.getElementById("pageCalLeft").addEventListener("click",function(){switchWeek("left")})};document.addEventListener("DOMContentLoaded",function(){Renderers.renderDateTitles(0),bindEvents()});